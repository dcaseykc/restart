FROM gitpod/workspace-full
LABEL maintainer="Restart Us <admin@restart.us>"
# Set environment for setup
ARG CONDA_ENV=restart
# must use numbers for this gitpod override in makefile
ARG DOCKER_USER=gitpod
ARG DOCKER_UID=33333
ENV ENV=none

# To be used in gitpod.io must be debian/ubuntu or alpine based
# Must also have a gitpod use
# With the jupyter/scipy-notebook base we end up with two users
# gitpod and joyvan
include(lib/lib.docker)

# if you can figure out where apt-get installs
# this could also become
# FROM restart/debug AS debug
# Then in the current container
# COPY --from=debug /usr/bin /usr/bin
include(lib/debug.docker)

USER $DOCKER_USER

# gitpod does not like anaconda
# create_conda($PYTHON,$PIP,$PIP_ONLY,PIP_DEV)

# this works
# ENV=none means do not use pipenv ENV=pipenv enables it
WORKDIR /home/$DOCKER_USER
RUN echo "ENV=none" >> ".bashrc"
create_gitpod($PYTHON,$PIP,$PIP_ONLY,$PIP_DEV)

create_gitpod_pipenv($PYTHON,$PIP,$PIP_ONLY,$PIP_DEV)
